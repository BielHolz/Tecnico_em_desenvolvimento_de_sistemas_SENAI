CREATE DATABASE db_rh;
USE db_rh;

CREATE TABLE TBpessoas (
codpessoas INT AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(45) NOT NULL,
datanascimento DATETiME,
sexo CHAR(1)
);

CREATE TABLE TBlogin (
codlogin INT AUTO_INCREMENT PRIMARY KEY,
login VARCHAR(45) NOT NULL,
email VARCHAR(45) NOT NULL,
senha VARCHAR(45) NOT NULL,
FOREIGN KEY (TBpessoas) REFERENCES TBpessoas(codpessoas)
);


CREATE TABLE TBpessoasFisicas (
codpessoasFisicas INT AUTO_INCREMENT PRIMARY KEY,
cpf VARCHAR(11) NOT NULL,
cnh VARCHAR(45),
estadoCivil VARCHAR(45) NOT NULL,
empregado BIT(1),
deficiencia BIT(1) NOT NULL,
FOREIGN KEY (TBpessoas) REFERENCES TBpessoas(codpessoas)
);

CREATE TABLE  TBcurriculos (
codCurriculos INT AUTO_INCREMENT PRIMARY KEY,
cargoInteressado VARCHAR(100) NOT NULL,
pretensaoSalarial DECIMAL,
FOREIGN KEY (TBpessoasfisicas) REFERENCES TBpessoasFisicas(codpessoasFisicas)
);

CREATE TABLE TBidiomas (
codIdioma INT AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(45) NOT NULL,
FOREIGN KEY (TBcurriculos) REFERENCES TBcurriculos(codcurriculos)
);

CREATE TABLE TBempregos (
codEmpregos INT AUTO_INCREMENT PRIMARY KEY,
dataEntrada DATETIME NOT NULL,
dataSaida DATETIME NOT NULL,
cargo VARCHAR(45) NOT NULL,
salario DECIMAL NOT NULL,
atribuicoes VARCHAR(45) NOT NULL,
empresa VARCHAR(45) NOT NULL,
empregoAtual BIT(1) NOT NULL,
FOREIGN KEY (TBidiomas) REFERENCES TBidiomas(TBidiomas)
);

CREATE TABLE  TBformacoes (
codFormacao INT AUTO_INCREMENT PRIMARY KEY,
nomeCurso VARCHAR(45) NOT NULL,
nomeInstituicao VARCHAR(45) NOT NULL,
situacao CHAR(1) NOT NULL,
dataInicio DATETIME NOT NULL,
dataFim DATETIME NOT NULL,
FOREIGN KEY (TBtiposFormacao) REFERENCES TBtiposFormacao(TBtiposFormacao),
FOREIGN KEY (TBcurriculos) REFERENCES TBcurriculos(TBcurriculos)
);

CREATE TABLE TBtiposFormacao (
codTiposFormacao INT AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(45) NOT NULL
);

CREATE TABLE TBcidades (
codcidade INT AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(100),
FOREIGN KEY (TBestadis) REFERENCES TBestado (codestado)
);

CREATE TABLE TBendereco( 
codendereco INT AUTO_INCREMENT PRIMARY KEY,
endereco VARCHAR(80) NOT NULL,
bairro VARCHAR(45) NOT NULL,
complemento VARCHAR(50),
numero INT NOT NULL,
FOREIGN KEY (TBcidade) REFERENCES TBcidade (codcidade),
FOREIGN KEY (TBpessoas) REFERENCES TBpessoas (codpessoas)
);

CREATE TABLE TBestado (
codestado INT AUTO_INCREMENT PRIMARY KEY,
nome VARCHAR(100),
sigla VARCHAR(2)
);

CREATE TABLE TBpessoasjuridicas (
codpessoasjuridicas INT AUTO_INCREMENT PRIMARY KEY,
nomefantasia VARCHAR(45) NOT NULL,
cnpj VARCHAR(14) NOT NULL,
razaosocial VARCHAR(45) NOT NULL,
FOREIGN KEY (TBpessoas) REFERENCES TBpessoas (codpessoas)
);


CREATE TABLE TBturnos(
codturno INT AUTO_INCREMENT PRIMARY KEY,
descricao VARCHAR(45)
);

CREATE TABLE TBvagas(
codvaga INT AUTO_INCREMENT PRIMARY KEY,
descricao VARCHAR(100) NOT NULL,
salario DECIMAL NOT NULL,
cargo VARCHAR(45) NOT NULL,
experiencia VARCHAR(45) NOT NULL,
FOREIGN KEY (TBpessoasjuridicas) REFERENCES TBpessoasjuridicas (codpessoasjuridicas),
FOREIGN KEY (TBturnos) REFERENCES TBturnos (codturno)
);

INSERT INTO TBestado (nome,sigla) VALUES
('santa catarina','SC'),
('sao paulo','SP'),
('distrito federal','DF'),
('minas gerais','MG'),
('rio grande do sul','RS');

INSERT INTO TBcidades (nome, codestado) VALUES
('joinville', 1),
('florianopolis', 1),
('schroeder', 1),
('sorocaba', 2),
('brasilia', 3);

INSERT INTO TBpessoas (nome, datanascimento, sexo) VALUES
('Lara Luiza', 2009-08-05, 'f'),
('Adrian Holz', 2008-06-06, 'm'),
('Gabriel Holz', 2009-07-23, 'm'),
('Andriel Henrique Kath', '2009-06-03', 'm'),
('Joao Mateus Martis Guetzsinguer', '2008-12-24', 'm');

INSERT INTO TBenderecos (endereco, bairro, complemento, numero, codcidade, codpessoa) VALUES
('Rua Jose de oliveira', 'jardim sofia', 'nao tem', '211', 1, 1),
('Rua Egon behling', 'jardim sofia', 'nao tem', '42', 1, 2),
('Rua Iracema Luckow', 'jardim sofia', 'pe de sombreiro', '170', 1, 3),
('Rua Iracema Luckow', 'jardim sofia', 'pe de sombreiro', '170', 1, 4),
('Rua Joao Henrique Ferreira', 'espinheiros', 'portal do mar', '89', 1, 5);

INSERT INTO TBpessoas (cpf, cnh, estadoCivil, empregado, deficiencia, codpessoas) VALUES
('123.456.789-01', 'nao tem', 'namorando', 'sim', 'nao', 1),
('234.567.890-12', 'nao tem', 'namorando', 'sim', 'nao', 2),
('345.678.901-23', 'nao tem', 'solteiro', 'nao', 'nao', 3),
('456.789.012-34', 'nao tem', 'namorando', 'nao', 'nao', 4),
('567.890.123-45', 'nao tem', 'solteiro', 'nao', 'nao', 5);

SELECT nome 
FROM TBpessoas 
WHERE codpessoas IN (SELECT codpessoas FROM TBpessoasFisicas);

SELECT nome AS cidade,
       (SELECT sigla FROM TBestado WHERE codestado = TBcidades.codestado) AS estado
FROM TBcidades;

SELECT nome,
       (SELECT endereco FROM TBendereco WHERE codpessoas = TBpessoas.codpessoas) AS endereco,
       (SELECT nome FROM TBcidades 
        WHERE codcidade = (SELECT codcidade FROM TBendereco WHERE codpessoas = TBpessoas.codpessoas)) AS cidade
FROM TBpessoas;

SELECT nome,
       (SELECT CASE WHEN empregado = 1 THEN 'Sim' ELSE 'NÃ£o' END
        FROM TBpessoasFisicas 
        WHERE codpessoas = TBpessoas.codpessoas) AS empregado
FROM TBpessoas;

SELECT nome,
       (SELECT cpf FROM TBpessoasFisicas 
        WHERE codpessoas = TBpessoas.codpessoas AND deficiencia = 1) AS cpf
FROM TBpessoas
WHERE codpessoas IN (SELECT codpessoas FROM TBpessoasFisicas WHERE deficiencia = 1);


SELECT nome,
       (SELECT estadoCivil FROM TBpessoasFisicas 
        WHERE codpessoas = TBpessoas.codpessoas) AS estadoCivil
FROM TBpessoas;

SELECT nome, datanascimento
FROM TBpessoas
WHERE YEAR(datanascimento) > 1990;

SELECT nome,
       (SELECT nome FROM TBcidades 
        WHERE codcidade = (SELECT codcidade FROM TBendereco 
                           WHERE codpessoas = TBpessoas.codpessoas)) AS cidade,
       (SELECT sigla FROM TBestado 
        WHERE codestado = (SELECT codestado FROM TBcidades 
                           WHERE codcidade = (SELECT codcidade FROM TBendereco 
                                              WHERE codpessoas = TBpessoas.codpessoas))) AS estado
FROM TBpessoas;
